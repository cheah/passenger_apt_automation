Origin: http://nginx.org/download/patch.2017.ranges.txt
Subject: Fix integer overflow in the range filter
Upstream: yes

CVE-2017-7529
---
 src/http/modules/ngx_http_range_filter_module.c |    4 ++++
 1 file changed, 4 insertions(+)

Index: b/src/http/modules/ngx_http_range_filter_module.c
===================================================================
--- a/src/http/modules/ngx_http_range_filter_module.c
+++ b/src/http/modules/ngx_http_range_filter_module.c
@@ -377,6 +377,10 @@ ngx_http_range_parse(ngx_http_request_t
             range->start = start;
             range->end = end;
 
+            if (size > NGX_MAX_OFF_T_VALUE - (end - start)) {
+                return NGX_HTTP_RANGE_NOT_SATISFIABLE;
+            }
+
             size += end - start;
 
             if (ranges-- == 0) {
